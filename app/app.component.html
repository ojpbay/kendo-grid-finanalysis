<mat-toolbar color="primary" id="toolbar">
	<mat-toolbar-row>
		<span>Casualty Comparison</span>
		<span class="example-spacer"></span>

		<button mat-icon-button (click)="addStrategy()" matTooltip="Add New Strategy">
      <mat-icon>add</mat-icon>
    </button>

		<button mat-icon-button (click)="restoreColumns()" matTooltip="Restore Hidden Strategies">
      <mat-icon>refresh</mat-icon>
    </button>
	</mat-toolbar-row>

	<mat-toolbar-row fxLayout="row wrap" fxLayout.xs="column" fxLayoutAlign="start center">
		<ng-container *ngFor="let strategy of strategies">
			<div fxFlex="33"
				*ngIf="strategy.columnName !== 'lineOfBusiness' && strategy.columnName !== 'expiringStrategy'">

				<mat-checkbox id="{{strategy.columnName}}" [checked]="!isHidden(strategy.columnName)"
					(change)="hideColumn(strategy.columnName)">
					{{strategy.title}}
				</mat-checkbox>

			</div>
		</ng-container>
	</mat-toolbar-row>
</mat-toolbar>

<kendo-grid [data]="gridData" [reorderable]="true" [groupable]="false" [filterable]="false" [pageable]="false"
	[sortable]="false" (cellClick)="cellClickHandler($event)" [rowClass]="rowCallback">

	<kendo-grid-column field="lineOfBusiness" title="Quote Summary" width="200" [locked]="true">

	</kendo-grid-column>

	<!-- need to have at least one locked column -->
	<kendo-grid-column field="expiringPremium" title="Expiring" width="150" [locked]="false">
		<ng-template kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex">
			{{dataItem.expiringPremium | currency}}
		</ng-template>

		<ng-template kendoGridFooterTemplate>
			{{sumExpiringPremium | currency}}
		</ng-template>
	</kendo-grid-column>

	<ng-container *ngFor="let strat of strategies">
		<ng-container *ngIf="strat.columnName !== 'lineOfBusiness' && strat.columnName !== 'expiringStrategy'">

			<kendo-grid-column-group [title]="strat.title" [locked]="false" *ngIf="!isHidden(strat.columnName)">

				<ng-template kendoGridHeaderTemplate let-column let-columnIndex="columnIndex">
					<mat-toolbar style="height: 100px;">
						<mat-form-field class="full-width">
							<textarea matInput
                        [(ngModel)]='strat.title'
                        #autosize="cdkTextareaAutosize"
                        placeholder="Enter strategy name"
                        class="full-width"
                        cdkTextareaAutosize
                        cdkAutosizeMinRows="3"
                        cdkAutosizeMaxRows="5">
							</textarea>
						</mat-form-field>

						<span class="example-spacer"></span>

						<button mat-icon-button matTooltip="Copy Strategy" (click)="copyStrategy(strat)">
                <mat-icon>content_copy</mat-icon>
              </button>
						<button mat-icon-button class="example-icon" matTooltip="Delete Strategy" (click)="deleteStrategy(strat)">
                <mat-icon>delete</mat-icon>                
              </button>
					</mat-toolbar>


				</ng-template>

				<kendo-grid-column title="Quote" [locked]="false" width="200">

					<ng-template kendoGridCellTemplate let-dataItem="dataItem">
						<div class="placeholder">
							{{ (dataItem?.selectedPremium | currency) || 'Select Quote' }}
						</div>
					</ng-template>
					<ng-template kendoGridEditTemplate let-dataItem="dataItem" let-column="column"
						let-formGroup="formGroup">

						<mat-select [(value)]="dataItem.selectedPremium" placeholder="Select quote">
							<mat-option *ngFor="let quote of quotes" [value]="quote.premium">{{quote.name}}</mat-option>
						</mat-select>

					</ng-template>

					<ng-template kendoGridFooterTemplate>
						{{sumSelectedPremium | currency}}
					</ng-template>

				</kendo-grid-column>

				<kendo-grid-column title="Difference" [locked]="false" width="200">
					<ng-template kendoGridCellTemplate let-dataItem="dataItem">
						{{getDifference(dataItem)}}
					</ng-template>
				</kendo-grid-column>
			</kendo-grid-column-group>

		</ng-container>
	</ng-container>

</kendo-grid>